This is the code from the Haskell master class at AgileBaseCamp 2012
